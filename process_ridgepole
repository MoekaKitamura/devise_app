ğŸ§¡ridgepoleå®Ÿè£…

https://github.com/ridgepole/ridgepole

gem 'ridgepole'

$ bindle install

; database.yml ã® developmentæƒ…å ±ã‚’å…ƒã«ã—ã¦ db/Schemafile ã‚’ä½œæˆã™ã‚‹
$ bundle exec ridgepole -c config/database.yml -E development --export -o db/Schemafile
â†“
æ—¢å­˜ã®schema.rbã‚’å…ƒã«ã€ãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±ãŒè‡ªå‹•ã§åæ˜ ã™ã‚‹ï¼

; å®Ÿéš›ã®é©ç”¨ã®å‰ã« --dry-run ã«ã¦ç¢ºèª
bundle exec ridgepole -c config/database.yml -E development -f db/Schemafile --apply --dry-run

; LGTMãªã‚‰DBã«é©ç”¨ã™ã‚‹
bundle exec ridgepole -c config/database.yml -E development -f db/Schemafile --apply

; Herokuã®DBã«é©ç”¨ã™ã‚‹
[config/database.for.heroku.ridgepole.yml]ã‚’ä½œã£ã¦ã€ä¸­èº«æ›¸ã
  production:
    url: <%= ENV['DATABASE_URL'] %>

â†“
herokuã«pushã—ãŸã‚ã¨ã€
heroku run 'bundle exec ridgepole -c config/database.for.heroku.ridgepole.yml -E production -f db/Schemafile --apply' --app YOUR_HEROKU_APP_NAME
ä»Šå›ã¯ã€
heroku run 'bundle exec ridgepole -c config/database.for.heroku.ridgepole.yml -E production -f db/Schemafile --apply' --app devise-app-0905

ãƒ¢ãƒ‡ãƒ«ã¨ã‹ä½œã‚‹ã¨ãã¯ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚¹ã‚­ãƒƒãƒ—ï¼
$ rails g model amazonFlatFile --skip-migration

rails g scaffold Task title:string content:string --skip-migration

ã‚´ãƒŸæƒé™¤
db/schema.rb ã‚„ db/migrate ä»¥ä¸‹ã® migration ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‰Šé™¤ã—ã¦OKï¼

ã¨ã‚Šã‚ãˆãš.gitignoreã«æ›¸ã„ã¦ã‚‚OK
 db/schema.rb

-----------------------------------------------------
ã‚«ãƒ©ãƒ å¤‰æ›´ã—ã¦ã¿ã‚‹

/Schemafileã‚’ç·¨é›†
ä¸€ç•ªä¸‹ã«è¿½åŠ ã—ãŸã„ã‚«ãƒ©ãƒ ã‚’è¿½è¨˜

dry run ã‹ã‚‰ã€ã‚³ãƒãƒ³ãƒ‰ã†ã¤

â—ï¸ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ãŸã³ã«ã€ã‚³ãƒãƒ³ãƒ‰å¿˜ã‚Œãšã«ï¼ï¼
; å†èµ·å‹•ã™ã‚‹
heroku restart